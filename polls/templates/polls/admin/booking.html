<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
{% load static %}
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Administrator</title>

    {% include './include/link_lib.html' %}
</head>
<body>
    <div id="wrapper">
        {% include "./include/nav_horizontal.html" %}
        {% include "./include/nav_vertical.html" %}

        <div id="page-wrapper">
            <div id="page-inner">
                <div class="row">
                    <div class="col-md-12">
                        <h1 class="page-header">
                            Booking <small>List</small>
                        </h1>
                    </div>
                </div>
                <!-- /. ROW  -->

				<div class="row">
                    <div class="col-md-12">
                        <div class="panel panel-default">
                            {% if message and message != "" %}
                                <div class="alert alert-danger" role="alert">
                                    {{ message }}
                                </div>
                                <div class="panel-heading"></div>
                            {% endif %}
                            <div class="panel-body">
                                <table id="table" class="table table-striped table-bordered" cellspacing="0" width="100%">
                                    <thead>
                                        <tr>
                                            <th>ID</th>
                                            <th>Customer request</th>
                                            <th>Room</th>
                                            <th>Status</th>
                                            <th>Note</th>
                                            <th></th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        {% for booking in list_booking %}
                                        <tr>
                                            <td>{{ booking.idBooking }}</td>
                                            <td>
                                                <a type="button" class="bookroom-link" data-toggle="modal" data-target="#request{{ booking.idBooking }}">
                                                    {{ booking.customerRequest.customer.nameCustomer }}
                                                </a>
                                                <div class="modal" id="request{{ booking.idBooking }}">
                                                    <div class="modal-dialog">
                                                        <div class="modal-content">
                                                            <div class="modal-header">
                                                                <h4 class="modal-title"><b>Request information</b></h4>
                                                            </div>
                                                            <div class="modal-body">
                                                                <p><span class="modal-span">Id request</span>:&emsp; {{ booking.customerRequest.idRequest }}</p>
                                                                <p><span class="modal-span">Customer</span>:&emsp; {{ booking.customerRequest.customer.nameCustomer }}</p>
                                                                <p><span class="modal-span">Kind room</span>:&emsp; {{ booking.customerRequest.kind.nameKind }}</p>
                                                                <p><span class="modal-span">Date checkin</span>:&emsp; {{ booking.customerRequest.dateCheckin|date:"d/m/Y g:i:s" }}</p>
                                                                <p><span class="modal-span">Date checkout</span>:&emsp; {{ booking.customerRequest.dateCheckout|date:"d/m/Y g:i:s" }}</p>
                                                                <p><span class="modal-span">Note</span>:&emsp; {{ booking.customerRequest.note }}</p>
                                                            </div>
                                                            <div class="modal-footer">
                                                               <button type="button" class="btn btn-danger" data-dismiss="modal">Close</button>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </td>
                                            <td>{{ booking.room.nameRoom }}</td>
                                            <td>
                                                <input type="hidden" class="id" value="{{ booking.idBooking }}">
                                                <select name="status" class="status">
                                                    <option value="{{ booking.status }}" selected>{{ booking.get_status_display }}</option>
                                                    {% for status in list_status  %}
                                                        {% if status.0 != request.status %}
                                                            <option value="{{ status.0 }}">{{ status.1 }}</option>
                                                        {% endif %}
                                                    {% endfor %}
                                                </select>
                                            </td>
                                            <td>{{ booking.note }}</td>
                                            <td>
                                                <a href="/hihotel/admin/booking/delete/{{ booking.idBooking }}" class='btn btn-danger' onclick="return confirm('Are you sure?')">
                                                    <i class="fas fa-trash-alt"></i>
                                                </a>
                                            </td>
                                        </tr>
                                        {% endfor %}
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- /. WRAPPER  -->

    <!-- JS Scripts-->
    <!-- Metis Menu Js -->
    <script src="{% static 'polls/admin/assets/js/jquery.metisMenu.js' %}"></script>
    <!-- Morris Chart Js -->
    <script src="{% static 'polls/admin/assets/js/morris/raphael-2.1.0.min.js' %}"></script>

    <!-- Custom Js -->
    <script src="{% static 'polls/admin/assets/js/custom-scripts.js' %}"></script>

    <script>
        $('.status').change(function () {
            id = $(this).parent().children('.id').val();
            status = $(this).val();

            location.href = '/hihotel/admin/booking/edit/' + id + '/' + status + '/';
        });
    </script>


</body>
</html>